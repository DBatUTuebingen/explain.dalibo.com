{% set asset='plan' %}

{% extends "layout.html" %}

{% block title %}
{{ plan.title if plan else '' }}
{% endblock %}

{% block body %}
<main role="main" class="flex-grow-1 overflow-auto">
{% if plan %}
<script>
var title = {{ plan.title | tojson }};
var plan = {{ plan.plan | tojson }};
var sql = {{ plan.sql | tojson }};
</script>
{% endif %}
<div id="app" class="d-flex flex-column h-100">
<header class="header bg-dark">
  <nav class="navbar navbar-expand-md navbar-dark justify-content-between">
    <ul class="navbar-nav">
      <li class="nav-item active">
        <a class="nav-link p-0" href="{{ url_for('index') }}">
          <img src="{{ url_for('static', filename='img/logo_pev2.svg') }}" alt="Logo PEV2" height="35px;">
          Explain.dalibo.com
        </a>
      </li>
    </ul>
    <span class="navbar-text" v-cloak>
      {% raw %}{{ title }}{% endraw %}
    </span>
    {% if not plan %}
    <ul class="navbar-nav">
      <li class="nav-item active">
        <form method="POST" action="{{ url_for('new') }}" @submit.prevent="share">
          <button type="submit" class="btn btn-primary"
            id="shareButton"
          >
            <i class="fa fa-share-alt"></i> Share
          </button>
        </form>
      </li>
    </ul>
    {% else %}
    <span class="navbar-text">
      plan/{{ plan.id }}
    </span>
    {% endif %}
  </nav>
  {% if not plan %}
  <v-tour name="tour" :steps="tourSteps" :callbacks="tourCallbacks" :options="tourOptions"></v-tour>
  {% endif %}
</header>
<div class="d-flex flex-column h-100">
  <div class="flex-grow-1 overflow-auto d-flex">
    <pev2 :plan-source="plan" :plan-query="query" v-if="plan"></pev2>
    <div v-else class="w-100 h-100 d-flex">
      <div class="align-self-center mx-auto">
        Loading
      </div>
    </div>
  </div>
</div>
</main>
</div>
{% endblock %}

{% block header %}
{% endblock %}
